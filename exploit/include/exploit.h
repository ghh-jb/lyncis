#ifndef exploit_h
#define exploit_h

#include <stdio.h>
#include <stdlib.h>
#include <stdbool.h>
#include <sys/types.h>
#include <netinet/in.h>
#include <mach/mach.h>

typedef struct {
    mach_port_t tfp0;
    uint32_t kernel_text_base;
    uint32_t kernel_base;
    uint32_t kernel_slide;
    uint32_t self_port_addr;
    uint32_t self_task_addr;
    uint32_t self_proc_addr;
    uint32_t kern_task_addr;
    uint32_t kern_proc_addr;
    uint32_t kern_vm_map;
} kinfo_t;

kinfo_t *run_exploit(void);
void deinit_exploit(kinfo_t *kinfo);

#endif /* exploit_h */