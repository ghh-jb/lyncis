#include <stdio.h>
#include <stdlib.h>
#include <stdbool.h>
#include <unistd.h>
#include <sys/types.h>
#include <netinet/in.h>

#include "common.h"
#include "offsets.h"

offsets_t *offsets = NULL;

void init_device_offsets(void) {
    offsets = calloc(1, sizeof(offsets_t));
    offsets->task.vm_map = 0x18;
    offsets->task.next = 0x1c;
    offsets->task.prev = 0x20;
    offsets->task.itk_self = 0xa0;
    offsets->task.itk_space = 0x1a0;
    offsets->task.bsd_info = 0x1e8;

    offsets->ipc_port.io_bits = 0x0;
    offsets->ipc_port.io_references = 0x4;
    offsets->ipc_port.ip_receiver = 0x40;
    offsets->ipc_port.ip_kobject = 0x44;
    offsets->ipc_port.ip_srights = 0x5c;

    offsets->proc.pid = 0x8;
    offsets->proc.p_fd = 0x90;
    offsets->proc.ucred = 0x8c;

    offsets->file_desc.fd_ofiles = 0x0;
    offsets->file_proc.f_fglob = 0x8;
    offsets->file_glob.fg_data = 0x28;
    offsets->pipe.buffer = 0x10;

    offsets->ipc_space.is_table = 0x14;
    offsets->ipc_entry.size = 0x10;
}
